<?php require 'config.php'; if($_SERVER['REQUEST_METHOD']!=='POST'){ header('Location:index.php'); exit; } $email=$_POST['email']??''; $password=$_POST['password']??''; if(!$email||!$password){ header('Location:index.php?error=Missing'); exit; } $stmt=$mysqli->prepare('SELECT id,name,email,password,role FROM users WHERE email=? LIMIT 1'); $stmt->bind_param('s',$email); $stmt->execute(); $res=$stmt->get_result(); if($row=$res->fetch_assoc()){ if(password_verify($password,$row['password'])){ $_SESSION['user_id']=$row['id']; $_SESSION['name']=$row['name']; $_SESSION['email']=$row['email']; $_SESSION['role']=$row['role']; header('Location:'.($row['role']==='admin'?'admin_dashboard.php':'user_dashboard.php')); exit; } } header('Location:index.php?error=Invalid+credentials'); exit; ?>